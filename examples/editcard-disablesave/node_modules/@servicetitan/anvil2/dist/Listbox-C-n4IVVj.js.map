{"version":3,"file":"Listbox-C-n4IVVj.js","sources":["../src/internal/hooks/useTypeAhead/useTypeAhead.tsx","../src/components/Listbox/internal/ListboxContext.tsx","../src/components/Listbox/internal/ListboxOptionGroupContext.tsx","../src/components/Listbox/ListboxOption.tsx","../src/components/Listbox/internal/utils.ts","../src/components/Listbox/ListboxOptionGroup.tsx","../src/components/Listbox/Listbox.tsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\n/**\n * Custom hook for implementing type-ahead functionality.\n *\n * Features:\n * - Accumulates typed characters with automatic timeout clearing\n * - Provides type-ahead string for keyboard navigation\n * - Automatically resets after specified timeout period\n * - Supports customizable timeout duration\n * - Uses useEffect for automatic cleanup\n * - Optimized for keyboard navigation in lists and menus\n *\n * @param timeout - Timeout duration in milliseconds before clearing the type-ahead string\n * @returns Tuple containing current type-ahead string and function to update it\n */\nexport const useTypeAhead = (\n  timeout = 750,\n): [string, (char: string) => void] => {\n  const [typeAhead, setTypeAhead] = useState(\"\");\n\n  useEffect(() => {\n    const timer = setTimeout(() => setTypeAhead(\"\"), timeout);\n    return () => clearTimeout(timer);\n  }, [typeAhead, timeout]);\n\n  const updateTypeAhead = (char: string) => setTypeAhead((prev) => prev + char);\n\n  return [typeAhead, updateTypeAhead];\n};\n","import { createContext, Dispatch, SetStateAction, useContext } from \"react\";\nimport { ListboxProps } from \"../Listbox\";\n\n/**\n * Context properties for the Listbox component\n * @template T - The type of additional properties for items\n */\nexport type ListboxContextProps<T> = {\n  /** ID of the currently focused option */\n  currentFocus?: string;\n  /** Function to set the currently focused option */\n  setCurrentFocus: Dispatch<\n    SetStateAction<ListboxContextProps<T>[\"currentFocus\"]>\n  >;\n  /** Currently selected option(s) */\n  selected: ListboxProps<T>[\"defaultSelected\"];\n  /** Function to set the selected option(s) */\n  setSelected: Dispatch<SetStateAction<ListboxContextProps<T>[\"selected\"]>>;\n  /** List of available option elements */\n  options: NodeListOf<HTMLElement> | undefined;\n  /** Current selection mode */\n  selectionMode: Exclude<ListboxProps<T>[\"selectionMode\"], undefined>;\n  /** Callback when selection changes */\n  onSelectionChange: ListboxProps<T>[\"onSelectionChange\"];\n  /** Whether auto-select on focus is disabled */\n  disableAutoSelectOnFocus: boolean;\n  /** Array of items if using items prop */\n  items?: unknown[];\n  /** Whether the component is controlled */\n  controlled?: boolean;\n};\n\n/**\n * Context for sharing listbox state between components\n */\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const ListboxContext = createContext<ListboxContextProps<any> | null>(\n  null,\n);\n\n/**\n * Hook to access the listbox context\n * @returns The listbox context\n * @throws Error if used outside of a Listbox component\n */\nexport const useListbox = () => {\n  const context = useContext(ListboxContext);\n\n  if (context == null) {\n    throw new Error(\"useListbox must be wrapped in <Listbox />\");\n  }\n\n  return context;\n};\n","import { createContext } from \"react\";\n\ntype ListboxOptionGroupContextProps = {\n  disabled?: boolean;\n};\n\nexport const ListboxOptionGroupContext =\n  createContext<ListboxOptionGroupContextProps>({});\n","import {\n  ComponentPropsWithoutRef,\n  forwardRef,\n  useContext,\n  MouseEvent,\n} from \"react\";\nimport { Icon } from \"../Icon\";\nimport { Flex, FlexProps } from \"../Flex\";\nimport Check from \"@servicetitan/hammer-icon/mdi/round/check.svg\";\nimport { DataTrackingId } from \"../../types\";\nimport { useListbox } from \"./internal/ListboxContext\";\nimport { useTrackingId } from \"../../hooks\";\nimport { ListboxOptionGroupContext } from \"./internal/ListboxOptionGroupContext\";\n\nimport cx from \"classnames\";\nimport styles from \"./Listbox.module.scss\";\n\ntype ItemType = {\n  label: string;\n  [key: string]: unknown;\n};\n\n/**\n * Props for the ListboxOption component\n * @extends ComponentPropsWithoutRef<\"li\">\n */\nexport type ListboxOptionProps = ComponentPropsWithoutRef<\"li\"> & {\n  /** The value of the option */\n  value?: string;\n  /** Whether the option is disabled */\n  disabled?: boolean;\n  /** Flex alignment for items */\n  alignItems?: FlexProps[\"alignItems\"];\n  /** Flex justification for items */\n  justifyItems?: FlexProps[\"justifyItems\"];\n  /** Flex alignment for content */\n  alignContent?: FlexProps[\"alignContent\"];\n  /** Flex justification for content */\n  justifyContent?: FlexProps[\"justifyContent\"];\n  /** Flex place-items property */\n  placeItems?: FlexProps[\"placeItems\"];\n  /** Flex place-content property */\n  placeContent?: FlexProps[\"placeContent\"];\n} & (\n    | {\n        /** The item object when using items prop */\n        item: ItemType;\n        /** The display label for the option (optional if item is provided) */\n        label?: string;\n      }\n    | {\n        /** The display label for the option */\n        label: string;\n        /** No item object when using label directly */\n        item?: never;\n      }\n  ) &\n  DataTrackingId;\n\n/**\n * ListboxOption component for individual selectable items within a listbox.\n *\n * Features:\n * - Displays selectable options with proper ARIA attributes\n * - Supports disabled state for non-selectable options\n * - Keyboard navigation support\n * - Accessible with screen reader support\n *\n * @example\n * <ListboxOption value=\"option1\" label=\"Option 1\" />\n */\nexport const ListboxOption = forwardRef<HTMLLIElement, ListboxOptionProps>(\n  (props, ref) => {\n    const {\n      className,\n      children,\n      disabled: disabledProp,\n      onClick,\n      label: labelProp,\n      item,\n      value,\n      alignItems,\n      justifyItems,\n      alignContent,\n      justifyContent,\n      placeItems,\n      placeContent,\n      ...rest\n    } = props;\n\n    const {\n      setCurrentFocus,\n      currentFocus,\n      selected,\n      setSelected,\n      selectionMode,\n      onSelectionChange,\n      controlled,\n    } = useListbox();\n\n    const label = labelProp || item?.label || \"\";\n\n    const { disabled: groupDisabled } = useContext(ListboxOptionGroupContext);\n    const disabled =\n      groupDisabled || disabledProp || (item?.disabled as boolean) || false;\n\n    const isSelected = () => {\n      if (selectionMode === \"single\") {\n        if (item) {\n          return selected?.label === label;\n        }\n        return selected === label;\n      }\n      if (selectionMode === \"multiple\") {\n        const selectedItems = Array.isArray(selected)\n          ? selected\n          : selected\n            ? [selected]\n            : [];\n        if (item) {\n          return selectedItems.some(\n            (selectedItem) => selectedItem.label === label,\n          );\n        }\n        return selectedItems.includes(label);\n      }\n      return false;\n    };\n\n    const onClickHandler = (e: MouseEvent<HTMLLIElement>) => {\n      if (disabled) return;\n\n      onClick?.(e);\n      setCurrentFocus?.(label);\n\n      if (selectionMode === \"single\") {\n        if (\n          (!item && selected === label) ||\n          (item && selected?.label === label)\n        ) {\n          if (!controlled) {\n            setSelected?.(undefined);\n          }\n          onSelectionChange?.(undefined);\n          return;\n        }\n\n        if (item) {\n          if (!controlled) {\n            setSelected?.(item);\n          }\n          onSelectionChange?.(item);\n          return;\n        }\n\n        if (!item) {\n          if (!controlled) {\n            setSelected?.(label);\n          }\n          onSelectionChange?.(label);\n          return;\n        }\n      }\n\n      if (selectionMode === \"multiple\") {\n        const selectedItems = Array.isArray(selected)\n          ? selected\n          : selected\n            ? [selected]\n            : [];\n        if (\n          item &&\n          selectedItems.some((selectedItem) => selectedItem.label === label)\n        ) {\n          const selectedItemsWithItemRemoved = selectedItems.filter(\n            (selectedItem) => selectedItem.label !== label,\n          );\n          setSelected?.(selectedItemsWithItemRemoved);\n          onSelectionChange?.(selectedItemsWithItemRemoved);\n          return;\n        }\n\n        if (!item && selectedItems.includes(label)) {\n          const selectedItemsWithItemRemoved = selectedItems.filter(\n            (selectedItem) => selectedItem !== label,\n          );\n          setSelected?.(selectedItemsWithItemRemoved);\n          onSelectionChange?.(selectedItemsWithItemRemoved);\n          return;\n        }\n\n        if (item) {\n          const selectedItemsWithItemAdded = [...selectedItems, item];\n          setSelected?.(selectedItemsWithItemAdded);\n          onSelectionChange?.(selectedItemsWithItemAdded);\n          return;\n        }\n\n        if (!item) {\n          const selectedItemsWithItemAdded = [...selectedItems, label];\n          setSelected?.(selectedItemsWithItemAdded);\n          onSelectionChange?.(selectedItemsWithItemAdded);\n          return;\n        }\n      }\n    };\n\n    const data = {\n      value: props.value,\n      label: \"item\" in props ? props.item?.label : props.label,\n    };\n\n    const trackingId = useTrackingId({\n      name: \"ListboxOption\",\n      data,\n      hasOverride: !!props[\"data-tracking-id\"],\n    });\n\n    const ListboxOptionClassNames = cx(styles[\"option\"], className, {});\n\n    return (\n      <li // eslint-disable-line jsx-a11y/click-events-have-key-events\n        data-tracking-id={trackingId}\n        className={ListboxOptionClassNames}\n        data-anv=\"listbox-option\"\n        role=\"option\"\n        aria-disabled={disabled}\n        data-focused={currentFocus === label}\n        aria-selected={isSelected()}\n        id={label}\n        onClick={onClickHandler}\n        ref={ref}\n        value={value ?? label}\n        {...rest}\n      >\n        <Flex\n          className={styles[\"children\"]}\n          grow={1}\n          shrink={1}\n          alignItems={alignItems}\n          justifyItems={justifyItems}\n          alignContent={alignContent}\n          justifyContent={justifyContent}\n          placeItems={placeItems}\n          placeContent={placeContent}\n        >\n          {children}\n        </Flex>\n        <Icon\n          aria-hidden\n          svg={Check}\n          inherit\n          className={styles[\"Icon\"]}\n          style={{ opacity: isSelected() ? 1 : 0 }}\n        />\n      </li>\n    );\n  },\n);\n\nListboxOption.displayName = \"ListboxOption\";\n","import { KeyboardEvent } from \"react\";\nimport { ListboxContextProps } from \"./ListboxContext\";\n\nexport const scrollToOption = (node: HTMLElement | undefined) => {\n  node?.scrollIntoView({\n    block: \"nearest\",\n    inline: \"center\",\n  });\n};\n\nexport const onListboxKeyDown = (\n  e: KeyboardEvent<HTMLUListElement>,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  context: ListboxContextProps<any>,\n) => {\n  const {\n    options,\n    currentFocus,\n    selectionMode,\n    onSelectionChange,\n    selected,\n    setSelected,\n    items,\n    controlled,\n  } = context;\n\n  if (!options) return;\n\n  const currentNode = Array.from(options).find(\n    (node) => node.id === currentFocus,\n  ) as HTMLElement;\n\n  const currentIndex = Array.from(options).indexOf(currentNode);\n\n  switch (e.code) {\n    case \"ArrowDown\":\n      e.preventDefault();\n      if (currentIndex === options.length - 1) {\n        goTo(options[0], 0, context);\n      } else {\n        goTo(options[currentIndex + 1], currentIndex + 1, context);\n      }\n      break;\n    case \"ArrowUp\":\n      e.preventDefault();\n      if (currentIndex === 0) {\n        goTo(options[options.length - 1], options.length - 1, context);\n      } else {\n        goTo(options[currentIndex - 1], currentIndex - 1, context);\n      }\n      break;\n    case \"Home\":\n      e.preventDefault();\n      goTo(options[0], 0, context);\n      break;\n    case \"End\":\n      e.preventDefault();\n      goTo(options[options.length - 1], options.length - 1, context);\n      break;\n\n    case \"Enter\":\n    case \"Space\":\n      e.preventDefault();\n\n      if (!currentFocus) return;\n      if (controlled) return;\n\n      if (selectionMode === \"single\") {\n        if (\n          typeof selected === \"object\"\n            ? selected.label === currentFocus\n            : selected === currentFocus\n        ) {\n          setSelected?.(undefined);\n          onSelectionChange?.(undefined);\n          return;\n        }\n\n        if (items) {\n          const enabledItems = items.filter(\n            (item) => !(item as { disabled?: boolean })?.disabled,\n          );\n          setSelected?.(enabledItems[currentIndex]);\n          onSelectionChange?.(enabledItems[currentIndex]);\n          return;\n        }\n\n        if (!items) {\n          setSelected?.(currentFocus);\n          onSelectionChange?.(currentFocus);\n          return;\n        }\n      }\n\n      if (selectionMode === \"multiple\") {\n        const selectedItems = Array.isArray(selected) ? selected : [selected];\n\n        if (items) {\n          const focusedItem = items.find(\n            (item) => (item as { label: string }).label === currentFocus,\n          );\n\n          if (selectedItems.includes(focusedItem)) {\n            const selectedItemsWithItemRemoved = selectedItems.filter(\n              (selectedItem) => selectedItem !== focusedItem,\n            );\n            setSelected?.(selectedItemsWithItemRemoved);\n            onSelectionChange?.(selectedItemsWithItemRemoved);\n            return;\n          } else {\n            const selectedItemsWithItemAdded = [...selectedItems, focusedItem];\n\n            setSelected?.(selectedItemsWithItemAdded);\n            onSelectionChange?.(selectedItemsWithItemAdded);\n            return;\n          }\n        }\n\n        if (!items) {\n          if (selectedItems.includes(currentFocus)) {\n            setSelected?.(\n              selectedItems.filter((item) => item !== currentFocus),\n            );\n            onSelectionChange?.(\n              selectedItems.filter((item) => item !== currentFocus),\n            );\n            return;\n          }\n          setSelected?.([...selectedItems, currentFocus]);\n          onSelectionChange?.([...selectedItems, currentFocus]);\n        }\n      }\n      break;\n\n    default:\n      break;\n  }\n};\n\nconst goTo = (\n  option: HTMLElement,\n  index: number,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  context: ListboxContextProps<any>,\n) => {\n  const {\n    setCurrentFocus,\n    setSelected,\n    selectionMode,\n    disableAutoSelectOnFocus,\n    onSelectionChange,\n    items,\n    controlled,\n  } = context;\n\n  scrollToOption(option);\n  if (disableAutoSelectOnFocus || selectionMode === \"multiple\") {\n    setCurrentFocus(option?.id);\n    return;\n  }\n\n  setCurrentFocus(option?.id);\n\n  if (controlled) return;\n\n  if (items) {\n    const enabledItems = items.filter(\n      (item) => !(item as { disabled?: boolean })?.disabled,\n    );\n    setSelected(enabledItems[index]);\n    onSelectionChange?.(enabledItems[index]);\n  } else {\n    setSelected(option?.id);\n    onSelectionChange?.(option?.id);\n  }\n};\n","import { ComponentPropsWithoutRef, forwardRef } from \"react\";\nimport { Text } from \"../Text\";\nimport { ListboxOptionGroupContext } from \"./internal/ListboxOptionGroupContext\";\n\nimport cx from \"classnames\";\nimport styles from \"./Listbox.module.scss\";\n\n/**\n * Props for the ListboxOptionGroup component\n * @extends ComponentPropsWithoutRef<\"div\">\n */\nexport type ListboxOptionGroupProps = ComponentPropsWithoutRef<\"div\"> & {\n  /** Whether the group is disabled */\n  disabled?: boolean;\n  /** The label for the option group */\n  label: string;\n};\n\n/**\n * ListboxOptionGroup component for grouping related options within a listbox.\n *\n * Features:\n * - Groups related options with a descriptive label\n * - Maintains proper ARIA structure for accessibility\n * - Supports keyboard navigation within groups\n * - Visual separation of option categories\n *\n * @example\n * <ListboxOptionGroup label=\"Fruits\">\n *   <ListboxOption value=\"apple\">Apple</ListboxOption>\n *   <ListboxOption value=\"banana\">Banana</ListboxOption>\n * </ListboxOptionGroup>\n */\nexport const ListboxOptionGroup = forwardRef<\n  HTMLDivElement,\n  ListboxOptionGroupProps\n>((props, ref) => {\n  const { className, children, disabled, label, ...rest } = props;\n\n  const optionGroupCx = cx(styles[\"option-group\"], className);\n\n  const labelCx = cx(styles[\"label\"], {\n    [styles[\"disabled\"]]: disabled,\n  });\n\n  return (\n    <ListboxOptionGroupContext.Provider value={{ disabled }}>\n      <div\n        data-anv=\"listbox-option-group\"\n        className={optionGroupCx}\n        ref={ref}\n        {...rest}\n      >\n        <Text variant=\"eyebrow\" className={labelCx}>\n          {label}\n        </Text>\n\n        {children}\n      </div>\n    </ListboxOptionGroupContext.Provider>\n  );\n});\n\nListboxOptionGroup.displayName = \"ListboxOptionGroup\";\n","import {\n  Ref,\n  forwardRef,\n  ReactNode,\n  ComponentPropsWithoutRef,\n  useRef,\n  useState,\n  useEffect,\n  KeyboardEvent,\n  FocusEvent,\n  useMemo,\n} from \"react\";\nimport { LayoutUtilProps } from \"../../types\";\nimport { ListboxOption } from \"./ListboxOption\";\nimport { ListboxContext, ListboxContextProps } from \"./internal/ListboxContext\";\nimport { onListboxKeyDown, scrollToOption } from \"./internal/utils\";\nimport { useMergeRefs } from \"../../hooks\";\nimport { ListboxOptionGroup } from \"./ListboxOptionGroup\";\n\nimport cx from \"classnames\";\nimport styles from \"./Listbox.module.scss\";\nimport { useLayoutPropsUtil, useTypeAhead } from \"../../internal/hooks\";\n\n/**\n * Represents an item in the listbox with a label and optional disabled state.\n * @template T - The type of additional properties for the item\n */\nexport type ListboxItemType<T> = T & {\n  /** The display label for the item */\n  label: string;\n  /** Whether the item is disabled and cannot be selected */\n  disabled?: boolean;\n};\n\n/**\n * Props for single selection mode without items array\n */\ntype SingleWithoutItems = {\n  /** Selection mode for single item selection */\n  selectionMode?: \"single\";\n  /** Whether to disable automatic selection when focusing on an option */\n  disableAutoSelectOnFocus?: boolean;\n  /** Currently selected item (controlled) */\n  selected?: string;\n  /** Default selected item (uncontrolled) */\n  defaultSelected?: string;\n  /** Callback when selection changes */\n  onSelectionChange?: (selected: string | undefined) => void;\n  /** Items array - not allowed in this mode */\n  items?: never;\n  /** Child elements to render */\n  children: ReactNode;\n};\n\n/**\n * Props for multiple selection mode without items array\n */\ntype MultipleWithoutItems = {\n  /** Selection mode for multiple item selection */\n  selectionMode: \"multiple\";\n  /** Auto-select on focus is not available in multiple mode */\n  disableAutoSelectOnFocus?: never;\n  /** Currently selected items (controlled) */\n  selected?: string[];\n  /** Default selected items (uncontrolled) */\n  defaultSelected?: string[];\n  /** Callback when selection changes */\n  onSelectionChange?: (selected: string[] | undefined) => void;\n  /** Items array - not allowed in this mode */\n  items?: never;\n  /** Child elements to render */\n  children: ReactNode;\n};\n\n/**\n * Props for single selection mode with items array\n * @template T - The type of additional properties for items\n */\ntype SingleWithItems<T> = {\n  /** Selection mode for single item selection */\n  selectionMode?: \"single\";\n  /** Whether to disable automatic selection when focusing on an option */\n  disableAutoSelectOnFocus?: boolean;\n  /** Currently selected item (controlled) */\n  selected?: ListboxItemType<T>;\n  /** Default selected item (uncontrolled) */\n  defaultSelected?: ListboxItemType<T>;\n  /** Callback when selection changes */\n  onSelectionChange?: (selected: ListboxItemType<T> | undefined) => void;\n  /** Array of items to render */\n  items: ListboxItemType<T>[];\n  /** Optional render function for items */\n  children?: ({ items }: { items: ListboxItemType<T>[] }) => ReactNode;\n};\n\n/**\n * Props for multiple selection mode with items array\n * @template T - The type of additional properties for items\n */\ntype MultipleWithItems<T> = {\n  /** Selection mode for multiple item selection */\n  selectionMode?: \"multiple\";\n  /** Auto-select on focus is not available in multiple mode */\n  disableAutoSelectOnFocus?: never;\n  /** Currently selected items (controlled) */\n  selected?: ListboxItemType<T>[];\n  /** Default selected items (uncontrolled) */\n  defaultSelected?: ListboxItemType<T>[];\n  /** Callback when selection changes */\n  onSelectionChange?: (selected: ListboxItemType<T>[] | undefined) => void;\n  /** Array of items to render */\n  items: ListboxItemType<T>[];\n  /** Optional render function for items */\n  children?: ({ items }: { items: ListboxItemType<T>[] }) => ReactNode;\n};\n\n/**\n * Props for the Listbox component\n * @template T - The type of additional properties for items\n * @extends ComponentPropsWithoutRef<\"ul\">\n * @extends LayoutUtilProps\n */\nexport type ListboxProps<T> = Omit<ComponentPropsWithoutRef<\"ul\">, \"children\"> &\n  LayoutUtilProps &\n  (\n    | SingleWithoutItems\n    | MultipleWithoutItems\n    | SingleWithItems<T>\n    | MultipleWithItems<T>\n  );\n\n/**\n * Listbox component for selecting one or more items from a list\n *\n * Features:\n * - Supports single and multiple selection modes\n * - Keyboard navigation with arrow keys and type-ahead\n * - Optional auto-selection on focus\n * - Controlled and uncontrolled modes\n * - Accessible with proper ARIA attributes\n * - Supports custom item rendering\n * - Option grouping for organization\n * - Layout utilities for positioning and spacing\n * - Automatic tracking ID generation for analytics\n *\n * @template T - The type of additional properties for items\n * @example\n * <Listbox selectionMode=\"single\" onSelectionChange={handleSelection}>\n *   <Listbox.Option value=\"option1\">Option 1</Listbox.Option>\n *   <Listbox.Option value=\"option2\">Option 2</Listbox.Option>\n * </Listbox>\n */\nconst ListboxElement = function <T>(\n  props: ListboxProps<T>,\n  ref: Ref<HTMLUListElement>,\n) {\n  const { layoutStyles, componentProps } = useLayoutPropsUtil(props);\n  const {\n    className,\n    selectionMode = \"single\",\n    items,\n    children,\n    onKeyDown,\n    onFocus,\n    onSelectionChange,\n    selected: selectedProp,\n    defaultSelected,\n    disableAutoSelectOnFocus,\n    style,\n    ...rest\n  } = componentProps;\n\n  const listboxRef = useRef<HTMLUListElement>(null);\n  const [selected, setSelected] = useState<ListboxProps<T>[\"defaultSelected\"]>(\n    selectedProp || defaultSelected,\n  );\n  const [options, setOptions] = useState<NodeListOf<HTMLElement>>();\n  const [typeAhead, updateTypeAhead] = useTypeAhead();\n  const [currentFocus, setCurrentFocus] = useState<\n    ListboxContextProps<T>[\"currentFocus\"]\n  >(\n    Array.isArray(selected)\n      ? typeof selected[0] === \"object\"\n        ? (selected as ListboxItemType<T>[])[0].label\n        : (selected as string[])[0]\n      : typeof selected === \"object\"\n        ? (selected as ListboxItemType<T>)?.label\n        : (selected as string),\n  );\n\n  const ListboxClassNames = cx(styles[\"listbox\"], className, {});\n\n  const controlled = selectedProp !== undefined;\n\n  useEffect(() => {\n    if (listboxRef.current) {\n      setOptions(\n        listboxRef.current.querySelectorAll(\n          \"[role=option]:not([aria-disabled='true'])\",\n        ),\n      );\n    }\n  }, [items, listboxRef, selectionMode]);\n\n  useEffect(\n    () => {\n      if (\"selected\" in componentProps) {\n        setSelected(selectedProp);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [selectedProp],\n  );\n\n  useEffect(() => {\n    if (!typeAhead.length) {\n      return;\n    }\n    const lowerTypeAhead = typeAhead.toLowerCase();\n    const nodes =\n      options &&\n      Array.from(options).filter((node) =>\n        node.innerText.toLowerCase().startsWith(lowerTypeAhead),\n      );\n\n    if (!nodes?.length) {\n      return;\n    }\n\n    let node = nodes[0];\n\n    if (lowerTypeAhead.length === 1 && nodes.length > 1) {\n      // Select next matching item on first key press if the list of matches contains our current selection WITH looping\n      const focusIndex = currentFocus\n        ? nodes.map((node) => node.id).indexOf(currentFocus)\n        : -1;\n      if (focusIndex > -1) {\n        let nextFocusIndex = focusIndex + 1;\n        if (nextFocusIndex === nodes.length) {\n          nextFocusIndex = 0;\n        }\n        node = nodes[nextFocusIndex];\n      }\n    }\n\n    setCurrentFocus(node.id);\n    scrollToOption(node);\n\n    if (controlled) return;\n\n    if (selectionMode === \"single\") {\n      if (items) {\n        if (disableAutoSelectOnFocus) {\n          const focusedItem = items.find(\n            (item) => (item as ListboxItemType<T>).label === currentFocus,\n          );\n          setSelected?.(focusedItem);\n          onSelectionChange?.(focusedItem);\n        }\n        return;\n      }\n\n      if (!items) {\n        if (disableAutoSelectOnFocus) {\n          setSelected(node.id);\n          onSelectionChange?.(node.id);\n        }\n        return;\n      }\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [typeAhead]);\n\n  const onKeyDownHandler = (e: KeyboardEvent<HTMLUListElement>) => {\n    onKeyDown?.(e);\n\n    if (new RegExp(/^[a-zA-Z0-9]$/i).test(e.key)) {\n      e.preventDefault();\n      e.stopPropagation();\n      updateTypeAhead(e.key);\n      return;\n    }\n\n    onListboxKeyDown(e, {\n      setCurrentFocus,\n      currentFocus,\n      setSelected,\n      selected,\n      selectionMode,\n      options,\n      onSelectionChange,\n      disableAutoSelectOnFocus: !!disableAutoSelectOnFocus,\n      items,\n    });\n  };\n\n  const onFocusHandler = (e: FocusEvent<HTMLUListElement>) => {\n    onFocus?.(e);\n\n    if (!options) return;\n\n    if (selectionMode === \"single\") {\n      const currentFocusExists = Array.from(options).some(\n        (item) => item.id === currentFocus,\n      );\n\n      if (currentFocus && currentFocusExists) return;\n      if (!items) {\n        if (currentFocusExists) {\n          setCurrentFocus(selected as string);\n          return;\n        }\n        setCurrentFocus(options[0].id);\n        return;\n      }\n      if (currentFocusExists) {\n        setCurrentFocus((selected as ListboxItemType<T>)?.label);\n        return;\n      }\n      setCurrentFocus(items?.[0].label);\n      return;\n    }\n\n    if (selectionMode === \"multiple\") {\n      const selectedArr = Array.isArray(selected) ? selected : [selected];\n      const currentFocusExists = Array.from(options).some(\n        (item) => item.id === currentFocus,\n      );\n\n      if (currentFocus && currentFocusExists) return;\n      if (!items) {\n        console.log({ currentFocus, currentFocusExists });\n        if (currentFocusExists) {\n          setCurrentFocus((selectedArr as ListboxItemType<T>[])[0].label);\n          return;\n        }\n        setCurrentFocus(options[0].id);\n        return;\n      }\n      if (currentFocusExists) {\n        setCurrentFocus((selectedArr as ListboxItemType<T>[])[0]?.label);\n        return;\n      }\n      setCurrentFocus(items?.[0].label);\n      return;\n    }\n\n    setCurrentFocus(options[0].id);\n  };\n\n  const mergeRef = useMergeRefs([ref, listboxRef]);\n\n  const styleCombined = {\n    ...style,\n    ...layoutStyles,\n  };\n\n  const value = useMemo(\n    () => ({\n      setCurrentFocus,\n      currentFocus,\n      setSelected,\n      selected,\n      selectionMode,\n      items,\n      options,\n      onSelectionChange,\n      disableAutoSelectOnFocus: !!disableAutoSelectOnFocus,\n      controlled,\n    }),\n    [\n      currentFocus,\n      disableAutoSelectOnFocus,\n      onSelectionChange,\n      options,\n      selected,\n      selectionMode,\n      items,\n      controlled,\n    ],\n  );\n\n  return (\n    <ListboxContext.Provider value={value}>\n      <ul\n        tabIndex={0}\n        role=\"listbox\"\n        style={styleCombined}\n        aria-multiselectable={selectionMode === \"multiple\" ? \"true\" : \"false\"}\n        aria-activedescendant={currentFocus}\n        className={ListboxClassNames}\n        data-anv=\"listbox\"\n        onKeyDown={onKeyDownHandler}\n        onFocus={onFocusHandler}\n        {...rest}\n        ref={mergeRef}\n      >\n        {items ? children?.({ items }) : children}\n      </ul>\n    </ListboxContext.Provider>\n  );\n};\n\n/**\n * Listbox component for selecting one or more items from a list\n *\n * Features:\n * - Supports single and multiple selection modes\n * - Keyboard navigation with arrow keys and type-ahead\n * - Optional auto-selection on focus\n * - Controlled and uncontrolled modes\n * - Accessible with proper ARIA attributes\n * - Supports custom item rendering\n * - Option grouping for organization\n * - Layout utilities for positioning and spacing\n * - Automatic tracking ID generation for analytics\n *\n * @template T - The type of additional properties for items\n * @example\n * <Listbox selectionMode=\"single\" onSelectionChange={handleSelection}>\n *   <Listbox.Option value=\"option1\">Option 1</Listbox.Option>\n *   <Listbox.Option value=\"option2\">Option 2</Listbox.Option>\n * </Listbox>\n */\nexport const Listbox = Object.assign(\n  forwardRef(ListboxElement) as <T>(\n    props: ListboxProps<T> & { ref?: React.ForwardedRef<HTMLUListElement> },\n  ) => ReturnType<typeof ListboxElement>,\n  {\n    /**\n     * ListboxOption component for individual selectable items within a listbox\n     *\n     * Features:\n     * - Displays selectable options with proper ARIA attributes\n     * - Supports disabled state for non-selectable options\n     * - Keyboard navigation support\n     * - Automatic tracking ID generation for analytics\n     * - Accessible with screen reader support\n     *\n     * @example\n     * <Listbox.Option value=\"option1\" label=\"Option 1\" />\n     */\n    Option: ListboxOption,\n    /**\n     * ListboxOptionGroup component for grouping related options within a listbox\n     *\n     * Features:\n     * - Groups related options with a descriptive label\n     * - Maintains proper ARIA structure for accessibility\n     * - Supports keyboard navigation within groups\n     * - Visual separation of option categories\n     *\n     * @example\n     * <Listbox.OptionGroup label=\"Fruits\">\n     *   <Listbox.Option value=\"apple\">Apple</Listbox.Option>\n     *   <Listbox.Option value=\"banana\">Banana</Listbox.Option>\n     * </Listbox.OptionGroup>\n     */\n    OptionGroup: ListboxOptionGroup,\n  },\n);\n"],"names":["styles","Check","node"],"mappings":"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"}