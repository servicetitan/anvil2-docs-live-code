{"version":3,"file":"TrackingProviderContext-CrVA7KHv.js","sources":["../src/providers/TrackingProvider/TrackingProviderContext.tsx"],"sourcesContent":["import { createContext, ReactNode } from \"react\";\n\n// These are intentionally made explicit and static to ensure that the\n// identifier is always the same for a given data and type.\n// Note that we could instead parse the scope to use as dataKey.\nconst dataKey = new TextEncoder().encode(\"1234567890123456\");\nconst iv = new TextEncoder().encode(\"1234567890123456\");\n\nconst encrypt = async ({ data }: { data: string }) => {\n  const encoder = new TextEncoder();\n  const encodedData = encoder.encode(data);\n\n  const cryptoKey = await crypto?.subtle?.importKey?.(\n    \"raw\",\n    dataKey,\n    { name: \"AES-CBC\" },\n    false,\n    [\"encrypt\"],\n  );\n\n  const encrypted = await crypto?.subtle?.encrypt?.(\n    { name: \"AES-CBC\", iv },\n    cryptoKey,\n    encodedData,\n  );\n\n  return btoa(String.fromCharCode(...new Uint8Array(encrypted)))\n    .substring(0, 20)\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\")\n    .replace(/=+$/, \"\");\n};\n\nexport const getTrackingIdHelper = async (\n  data: string,\n  component: string,\n  scope: string,\n) => {\n  const encryption = await encrypt({ data });\n  return `_${scope}_${component}_${encryption ?? \"\"}`;\n};\n\nexport interface TrackingProviderContextProps {\n  scope: string;\n  getTrackingId: (data: string, component: string) => Promise<string>;\n  optOut: boolean;\n}\n\nexport interface TrackingProviderProps {\n  children: ReactNode;\n  scope: string;\n  optOut?: boolean;\n}\n\nconst defaultContext: TrackingProviderContextProps = {\n  scope: \"ST\",\n  getTrackingId: (data: string, component: string) =>\n    getTrackingIdHelper(data, component, \"ST\"),\n  optOut: false,\n};\n\nexport const TrackingContext = createContext(defaultContext);\n"],"names":[],"mappings":";;AAKA,MAAM,OAAA,GAAU,IAAI,WAAA,EAAY,CAAE,OAAO,kBAAkB,CAAA;AAC3D,MAAM,EAAA,GAAK,IAAI,WAAA,EAAY,CAAE,OAAO,kBAAkB,CAAA;AAEtD,MAAM,OAAA,GAAU,OAAO,EAAE,IAAA,EAAK,KAAwB;AACpD,EAAA,MAAM,OAAA,GAAU,IAAI,WAAA,EAAY;AAChC,EAAA,MAAM,WAAA,GAAc,OAAA,CAAQ,MAAA,CAAO,IAAI,CAAA;AAEvC,EAAA,MAAM,SAAA,GAAY,MAAM,MAAA,EAAQ,MAAA,EAAQ,SAAA;AAAA,IACtC,KAAA;AAAA,IACA,OAAA;AAAA,IACA,EAAE,MAAM,SAAA,EAAU;AAAA,IAClB,KAAA;AAAA,IACA,CAAC,SAAS;AAAA,GACZ;AAEA,EAAA,MAAM,SAAA,GAAY,MAAM,MAAA,EAAQ,MAAA,EAAQ,OAAA;AAAA,IACtC,EAAE,IAAA,EAAM,SAAA,EAAW,EAAA,EAAG;AAAA,IACtB,SAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,OAAO,IAAA,CAAK,MAAA,CAAO,YAAA,CAAa,GAAG,IAAI,WAAW,SAAS,CAAC,CAAC,CAAA,CAC1D,SAAA,CAAU,CAAA,EAAG,EAAE,CAAA,CACf,OAAA,CAAQ,KAAA,EAAO,GAAG,CAAA,CAClB,OAAA,CAAQ,OAAO,GAAG,CAAA,CAClB,OAAA,CAAQ,KAAA,EAAO,EAAE,CAAA;AACtB,CAAA;AAEO,MAAM,mBAAA,GAAsB,OACjC,IAAA,EACA,SAAA,EACA,KAAA,KACG;AACH,EAAA,MAAM,UAAA,GAAa,MAAM,OAAA,CAAQ,EAAE,MAAM,CAAA;AACzC,EAAA,OAAO,IAAI,KAAK,CAAA,CAAA,EAAI,SAAS,CAAA,CAAA,EAAI,cAAc,EAAE,CAAA,CAAA;AACnD;AAcA,MAAM,cAAA,GAA+C;AAAA,EACnD,KAAA,EAAO,IAAA;AAAA,EACP,eAAe,CAAC,IAAA,EAAc,cAC5B,mBAAA,CAAoB,IAAA,EAAM,WAAW,IAAI,CAAA;AAAA,EAC3C,MAAA,EAAQ;AACV,CAAA;AAEO,MAAM,eAAA,GAAkB,cAAc,cAAc;;;;"}